(in-package :dgw)

(defconstant +c-1+ 0)
(defconstant +c-1#+ 1)
(defconstant +d-1b+ 1)
(defconstant +d-1+ 2)
(defconstant +d-1#+ 3)
(defconstant +e-1b+ 3)
(defconstant +e-1+ 4)
(defconstant +f-1+ 5)
(defconstant +f-1#+ 6)
(defconstant +g-1b+ 6)
(defconstant +g-1+ 7)
(defconstant +g-1#+ 8)
(defconstant +a-1b+ 8)
(defconstant +a-1+ 9)
(defconstant +a-1#+ 10)
(defconstant +b-1b+ 10)
(defconstant +b-1+ 11)
(defconstant +c0+ 12)
(defconstant +c0#+ 13)
(defconstant +d0b+ 13)
(defconstant +d0+ 14)
(defconstant +d0#+ 15)
(defconstant +e0b+ 15)
(defconstant +e0+ 16)
(defconstant +f0+ 17)
(defconstant +f0#+ 18)
(defconstant +g0b+ 18)
(defconstant +g0+ 19)
(defconstant +g0#+ 20)
(defconstant +a0b+ 20)
(defconstant +a0+ 21)
(defconstant +a0#+ 22)
(defconstant +b0b+ 22)
(defconstant +b0+ 23)
(defconstant +c1+ 24)
(defconstant +c1#+ 25)
(defconstant +d1b+ 25)
(defconstant +d1+ 26)
(defconstant +d1#+ 27)
(defconstant +e1b+ 27)
(defconstant +e1+ 28)
(defconstant +f1+ 29)
(defconstant +f1#+ 30)
(defconstant +g1b+ 30)
(defconstant +g1+ 31)
(defconstant +g1#+ 32)
(defconstant +a1b+ 32)
(defconstant +a1+ 33)
(defconstant +a1#+ 34)
(defconstant +b1b+ 34)
(defconstant +b1+ 35)
(defconstant +c2+ 36)
(defconstant +c2#+ 37)
(defconstant +d2b+ 37)
(defconstant +d2+ 38)
(defconstant +d2#+ 39)
(defconstant +e2b+ 39)
(defconstant +e2+ 40)
(defconstant +f2+ 41)
(defconstant +f2#+ 42)
(defconstant +g2b+ 42)
(defconstant +g2+ 43)
(defconstant +g2#+ 44)
(defconstant +a2b+ 44)
(defconstant +a2+ 45)
(defconstant +a2#+ 46)
(defconstant +b2b+ 46)
(defconstant +b2+ 47)
(defconstant +c3+ 48)
(defconstant +c3#+ 49)
(defconstant +d3b+ 49)
(defconstant +d3+ 50)
(defconstant +d3#+ 51)
(defconstant +e3b+ 51)
(defconstant +e3+ 52)
(defconstant +f3+ 53)
(defconstant +f3#+ 54)
(defconstant +g3b+ 54)
(defconstant +g3+ 55)
(defconstant +g3#+ 56)
(defconstant +a3b+ 56)
(defconstant +a3+ 57)
(defconstant +a3#+ 58)
(defconstant +b3b+ 58)
(defconstant +b3+ 59)
(defconstant +c4+ 60)
(defconstant +c4#+ 61)
(defconstant +d4b+ 61)
(defconstant +d4+ 62)
(defconstant +d4#+ 63)
(defconstant +e4b+ 63)
(defconstant +e4+ 64)
(defconstant +f4+ 65)
(defconstant +f4#+ 66)
(defconstant +g4b+ 66)
(defconstant +g4+ 67)
(defconstant +g4#+ 68)
(defconstant +a4b+ 68)
(defconstant +a4+ 69)
(defconstant +a4#+ 70)
(defconstant +b4b+ 70)
(defconstant +b4+ 71)
(defconstant +c5+ 72)
(defconstant +c5#+ 73)
(defconstant +d5b+ 73)
(defconstant +d5+ 74)
(defconstant +d5#+ 75)
(defconstant +e5b+ 75)
(defconstant +e5+ 76)
(defconstant +f5+ 77)
(defconstant +f5#+ 78)
(defconstant +g5b+ 78)
(defconstant +g5+ 79)
(defconstant +g5#+ 80)
(defconstant +a5b+ 80)
(defconstant +a5+ 81)
(defconstant +a5#+ 82)
(defconstant +b5b+ 82)
(defconstant +b5+ 83)
(defconstant +c6+ 84)
(defconstant +c6#+ 85)
(defconstant +d6b+ 85)
(defconstant +d6+ 86)
(defconstant +d6#+ 87)
(defconstant +e6b+ 87)
(defconstant +e6+ 88)
(defconstant +f6+ 89)
(defconstant +f6#+ 90)
(defconstant +g6b+ 90)
(defconstant +g6+ 91)
(defconstant +g6#+ 92)
(defconstant +a6b+ 92)
(defconstant +a6+ 93)
(defconstant +a6#+ 94)
(defconstant +b6b+ 94)
(defconstant +b6+ 95)
(defconstant +c7+ 96)
(defconstant +c7#+ 97)
(defconstant +d7b+ 97)
(defconstant +d7+ 98)
(defconstant +d7#+ 99)
(defconstant +e7b+ 99)
(defconstant +e7+ 100)
(defconstant +f7+ 101)
(defconstant +f7#+ 102)
(defconstant +g7b+ 102)
(defconstant +g7+ 103)
(defconstant +g7#+ 104)
(defconstant +a7b+ 104)
(defconstant +a7+ 105)
(defconstant +a7#+ 106)
(defconstant +b7b+ 106)
(defconstant +b7+ 107)
(defconstant +c8+ 108)
(defconstant +c8#+ 109)
(defconstant +d8b+ 109)
(defconstant +d8+ 110)
(defconstant +d8#+ 111)
(defconstant +e8b+ 111)
(defconstant +e8+ 112)
(defconstant +f8+ 113)
(defconstant +f8#+ 114)
(defconstant +g8b+ 114)
(defconstant +g8+ 115)
(defconstant +g8#+ 116)
(defconstant +a8b+ 116)
(defconstant +a8+ 117)
(defconstant +a8#+ 118)
(defconstant +b8b+ 118)
(defconstant +b8+ 119)
(defconstant +c9+ 120)
(defconstant +c9#+ 121)
(defconstant +d9b+ 121)
(defconstant +d9+ 122)
(defconstant +d9#+ 123)
(defconstant +e9b+ 123)
(defconstant +e9+ 124)
(defconstant +f9+ 125)
(defconstant +f9#+ 126)
(defconstant +g9b+ 126)
(defconstant +g9+ 127)
(defconstant +off+ 128)

(defun midi-key-name (key &optional (sharp t))
  (ecase key
    (0 "C-1")
    (1 (if sharp "C-1#" "D-1b"))
    (2 "D-1")
    (3 (if sharp "D-1#" "E-1b"))
    (4 "E-1")
    (5 "F-1")
    (6 (if sharp "F-1#" "G-1b"))
    (7 "G-1")
    (8 (if sharp "G-1#" "A-1b"))
    (9 "A-1")
    (10 (if sharp "A-1#" "B-1b"))
    (11 "B-1")
    (12 "C0")
    (13 (if sharp "C0#" "D0b"))
    (14 "D0")
    (15 (if sharp "D0#" "E0b"))
    (16 "E0")
    (17 "F0")
    (18 (if sharp "F0#" "G0b"))
    (19 "G0")
    (20 (if sharp "G0#" "A0b"))
    (21 "A0")
    (22 (if sharp "A0#" "B0b"))
    (23 "B0")
    (24 "C1")
    (25 (if sharp "C1#" "D1b"))
    (26 "D1")
    (27 (if sharp "D1#" "E1b"))
    (28 "E1")
    (29 "F1")
    (30 (if sharp "F1#" "G1b"))
    (31 "G1")
    (32 (if sharp "G1#" "A1b"))
    (33 "A1")
    (34 (if sharp "A1#" "B1b"))
    (35 "B1")
    (36 "C2")
    (37 (if sharp "C2#" "D2b"))
    (38 "D2")
    (39 (if sharp "D2#" "E2b"))
    (40 "E2")
    (41 "F2")
    (42 (if sharp "F2#" "G2b"))
    (43 "G2")
    (44 (if sharp "G2#" "A2b"))
    (45 "A2")
    (46 (if sharp "A2#" "B2b"))
    (47 "B2")
    (48 "C3")
    (49 (if sharp "C3#" "D3b"))
    (50 "D3")
    (51 (if sharp "D3#" "E3b"))
    (52 "E3")
    (53 "F3")
    (54 (if sharp "F3#" "G3b"))
    (55 "G3")
    (56 (if sharp "G3#" "A3b"))
    (57 "A3")
    (58 (if sharp "A3#" "B3b"))
    (59 "B3")
    (60 "C4")
    (61 (if sharp "C4#" "D4b"))
    (62 "D4")
    (63 (if sharp "D4#" "E4b"))
    (64 "E4")
    (65 "F4")
    (66 (if sharp "F4#" "G4b"))
    (67 "G4")
    (68 (if sharp "G4#" "A4b"))
    (69 "A4")
    (70 (if sharp "A4#" "B4b"))
    (71 "B4")
    (72 "C5")
    (73 (if sharp "C5#" "D5b"))
    (74 "D5")
    (75 (if sharp "D5#" "E5b"))
    (76 "E5")
    (77 "F5")
    (78 (if sharp "F5#" "G5b"))
    (79 "G5")
    (80 (if sharp "G5#" "A5b"))
    (81 "A5")
    (82 (if sharp "A5#" "B5b"))
    (83 "B5")
    (84 "C6")
    (85 (if sharp "C6#" "D6b"))
    (86 "D6")
    (87 (if sharp "D6#" "E6b"))
    (88 "E6")
    (89 "F6")
    (90 (if sharp "F6#" "G6b"))
    (91 "G6")
    (92 (if sharp "G6#" "A6b"))
    (93 "A6")
    (94 (if sharp "A6#" "B6b"))
    (95 "B6")
    (96 "C7")
    (97 (if sharp "C7#" "D7b"))
    (98 "D7")
    (99 (if sharp "D7#" "E7b"))
    (100 "E7")
    (101 "F7")
    (102 (if sharp "F7#" "G7b"))
    (103 "G7")
    (104 (if sharp "G7#" "A7b"))
    (105 "A7")
    (106 (if sharp "A7#" "B7b"))
    (107 "B7")
    (108 "C8")
    (109 (if sharp "C8#" "D8b"))
    (110 "D8")
    (111 (if sharp "D8#" "E8b"))
    (112 "E8")
    (113 "F8")
    (114 (if sharp "F8#" "G8b"))
    (115 "G8")
    (116 (if sharp "G8#" "A8b"))
    (117 "A8")
    (118 (if sharp "A8#" "B8b"))
    (119 "B8")
    (120 "C9")
    (121 (if sharp "C9#" "D9b"))
    (122 "D9")
    (123 (if sharp "D9#" "E9b"))
    (124 "E9")
    (125 "F9")
    (126 (if sharp "F9#" "G9b"))
    (127 "G9")
    (128 "OFF")))
